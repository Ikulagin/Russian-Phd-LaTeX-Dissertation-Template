/*Исходная транзакционная секция*/ 
int a, b;
...            
__transaction_atomic {
    if (a == 0)
        b = 1;
    else 
        a = 0;
} 
...